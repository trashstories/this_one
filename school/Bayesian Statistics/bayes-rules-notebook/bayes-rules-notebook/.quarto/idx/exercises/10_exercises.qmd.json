{"title":"10: Evaluating Regression Models","markdown":{"yaml":{"title":"10: Evaluating Regression Models","editor_options":{"chunk_output_type":"console"}},"headingText":"Load packages","containsRefs":false,"markdown":"\n\n```{r setup, warning=FALSE, message=FALSE}\n\nlibrary(bayesrules)\nlibrary(tidyverse)\nlibrary(bayesplot)\nlibrary(rstanarm)\nlibrary(rstan)\nlibrary(tidybayes)\nlibrary(janitor)\nlibrary(broom.mixed)\n\n```\n\n\n# 10.6.1 Conceptual exercises\n\n## Exercise 10.1 (The Big Three) \n\nWhen evaluating a model, what are the big three questions to ask yourself? \n\n1. **How fair is the model?**\n2. **How wrong is the model?**\n3. **How accurate are the posterior predictive models?**\n\n## Exercise 10.2 (Model fairness) \n\nGive an example of a model that will not be fair for each of the reasons below. Your examples don’t have to be from real life, but try to keep them in the realm of plausibility.\n\na. How the data was collected. **Collecting data to track foot traffic that also counts bicycles or other objects as people walking**\nb. The purpose of the data collection. **Collecting data through mobile apps to sell to other entities**\nc. Impact of analysis on society. **P-hacking to support a desirable conclusion**\nd. Bias baked into the analysis. **Using data influenced by human bias to make subjective predictions that appear fair mathematically**\n\n## Exercise 10.3 (Your perspective) \n\nEveryone has a standpoint or perspective that influences how they perceive the world. Rather than pretend that our standpoint is neutral, it is important to recognize it and how it might limit our ability to perceive the potential harms or benefits of our analyses.\n\na. Identify two aspects of your life experience that inform your standpoint or perspective. \n   i. **I have spent a significant portion of my adult life without a house or below the poverty line.**\n   ii. **I am a fat disabled woman in a world built on capitalist and patriarchal ideals that prioritize productivity, unattainable beauty standards, and masculine characteristics.**\nb. Identify how those two aspects of your life experience might limit your evaluation of future analyses.\n   i. **I will often assume the capitalists and those in power are the root cause of injustice.**\n   ii. **I may take on more than I can handle to stay ahead of those with more opportunity or privilege.**\nc. Identify how those two aspects of your life experience might benefit your evaluation of future analyses.\n   i. **I have a more nuanced understanding of the less obvious impacts of poverty.**\n   ii. **My perspective has less representation in previous researching offering a fresh approach.**\n\n## Exercise 10.4 (Neutrality?) \n\nThere are several instances in which data scientists might falsely consider themselves neutral. In this exercise, you will practice how to challenge the false idea of neutrality, an underappreciated skill for data scientists.\n\na. How would you respond if your colleague were to tell you “I’m just a neutral observer, so there’s no bias in my data analysis?”\nb. Your colleague now admits that they are not personally neutral, but they say “my model is neutral.” How do you respond to your colleague now?\nc. Give an example of when your personal experience or perspective has informed a data analysis.\n\n## Exercise 10.5 (That famous quote) \n\nGeorge Box famously said: “All models are wrong, but some are useful.” Write an explanation of what this quote means so that one of your non-statistical friends can understand.\n\n## Exercise 10.6 (Assumptions) \n\nProvide 3 assumptions of the Normal Bayesian linear regression model with $Y_i | \\beta_0, \\beta_1, \\sigma \\stackrel{ind}{\\sim} N(\\mu_i, \\sigma^2)$ where $\\mu_i = \\beta_0 + \\beta_1 X_i$.\n\n1. **Conditioned on $X$, the observed data $Y_i$ on case $i$ is independent of the observed data on any other case $j$.**\n2. **The typical $Y$ outcome can be written as a linear function of $X$0, $\\mu = \\beta_0 + \\beta_1 X$.**\n3. **At any $X$ value, $Y$ varies normally around $\\mu$ with consistent variability $\\sigma$.**\n\n## Exercise 10.7 (Mini posterior predictive check) \n\nSuppose we have a small dataset where predictor $X$ has values $\\vec{x} = (12, 10, 4, 8, 6)$, and response variable $Y$ has values $\\vec{y} = (20, 17, 4, 11, 9)$. Based on this data, we built a Bayesian linear regression model of $Y$ vs $X$.\n\na. In our first simulated parameter set, $\\left(\\beta_0^{(1)}, \\beta_1^{(1)}, \\sigma^{(1)} \\right) = (-1.8, 2.1, 0.8)$. Explain how you would use these values, combined with the data, to generate a prediction for $Y_1$.\nb. Using the first parameter set, generate predictions for $(Y_1, Y_2, \\ldots, Y_5)$. Comment on the difference between the predictions and the observed values $\\vec{y}$.\n   i. \n   \n```{r}\n\nx <- c(12,10,4,8,6)\ny <- c(20,17,4,11,9)\nsig <- .8\n\ndf <- data.frame(x = x, y = y, sig = sig)\n\n```\n\n``` {r, warning=FALSE, message=FALSE, results=FALSE, cache=TRUE}\n\ndf_model <- stan_glm(y ~ x, data = df,\n                     family = gaussian,\n                     prior_intercept = normal(5000, 1000),\n                     prior = normal(10, 5), \n                     prior_aux = exponential(0.8),\n                     chains = 4, iter = 5000*2, seed = 84735)\n\n# STEP 1: DEFINE the model\nstan_sample_model <- \"\n  data {\n    int<lower = 0> n;\n    vector[n] Y;\n    vector[n] X;\n  }\n  parameters {\n    real beta0;\n    real beta1;\n    real<lower = 0> sigma;\n  }\n  model {\n    Y ~ normal(beta0 + beta1 * X, sigma);\n    beta0 ~ normal(-2000, 1000);\n    beta1 ~ normal(100, 40);\n    sigma ~ exponential(0.0008);\n  }\n\"\n\n# STEP 2: SIMULATE the posterior\nstan_sample_sim <- \n  stan(model_code = stan_sample_model, \n       data = list(n = nrow(df), Y = df$y, X = df$x), \n       chains = 4, iter = 5000*2, seed = 84735)\n\n```\n\n``` {r}\n\ndf_model_df <- as.data.frame(df_model)\n\nfirst <- head(df_model_df, 1)\nfirst\n\nb0 <- first$`(Intercept)`\nb1 <- first$x\nsig  <- first$sigma\n\nset.seed(80085)\none_sim <- df %>%\n  mutate(mu = b0 + b1 * sig,\n         sim = rnorm(5, mean = mu, sd = sig)) %>%\n  select(x, y, sim)\n\npp_check(df_model, nreps = 50) + \n  xlab(\"x\")\n\n```\n\n## Exercise 10.8 (Explain to a friend: posterior predictive check) \n\nCongratulations! You have just completed a posterior predictive check for your regression model. Your friend Shefali has a lot of questions about this. Explain the following to Shefali in plain language:\n\na. The goal of a posterior predictive check.\nb. How to interpret the posterior predictive check results.\n\n## Exercise 10.9 (Explain to a friend: posterior predictive summary) \n\nShefali really appreciated your explanations from the previous exercise. She now wants you to explain posterior predictive summaries. Explain the following in plain language:\n\na. What the median absolute error tells us about your model.\nb. What the scaled median absolute error is, and why it might be an improvement over median absolute error.\nc. What the within-50 statistic tells us about your model.\n\n## Exercise 10.10 (Posterior predictive checks)\n\na. In `pp_check()` plots, what does the darker density represent? What does a single lighter-colored density represent?\nb. If our model fits well, describe how its `pp_check()` will appear. Explain why a good fitting model will produce a plot like this.\nc. If our model fits poorly, describe how its `pp_check()` might appear.\n\n## Exercise 10.11 (Cross-validation and tacos) \n\nRecall this example from the chapter: *Suppose you want to open a new taco stand. You build all of your recipes around Reem, your friend who prefers that anchovies be a part of every meal. You test your latest “anchov-ladas” dish on her and it’s a hit.*\n\na. What is the “data” in this analogy?\nb. What is the “model” in this analogy?\nc. How could you use cross-validation to evaluate a new taco recipe?\nd. Why would cross-validation help you develop a successful recipe?\n\n## Exercise 10.12 (Cross-validation)\n\na. What are the four steps for the k-fold cross-validation algorithm?\nb. What problems can occur when you use the same exact data to train and test a model?\nc. What questions do you have about k-fold cross-validation?\n","srcMarkdownNoYaml":"\n\n```{r setup, warning=FALSE, message=FALSE}\n\n# Load packages\nlibrary(bayesrules)\nlibrary(tidyverse)\nlibrary(bayesplot)\nlibrary(rstanarm)\nlibrary(rstan)\nlibrary(tidybayes)\nlibrary(janitor)\nlibrary(broom.mixed)\n\n```\n\n\n# 10.6.1 Conceptual exercises\n\n## Exercise 10.1 (The Big Three) \n\nWhen evaluating a model, what are the big three questions to ask yourself? \n\n1. **How fair is the model?**\n2. **How wrong is the model?**\n3. **How accurate are the posterior predictive models?**\n\n## Exercise 10.2 (Model fairness) \n\nGive an example of a model that will not be fair for each of the reasons below. Your examples don’t have to be from real life, but try to keep them in the realm of plausibility.\n\na. How the data was collected. **Collecting data to track foot traffic that also counts bicycles or other objects as people walking**\nb. The purpose of the data collection. **Collecting data through mobile apps to sell to other entities**\nc. Impact of analysis on society. **P-hacking to support a desirable conclusion**\nd. Bias baked into the analysis. **Using data influenced by human bias to make subjective predictions that appear fair mathematically**\n\n## Exercise 10.3 (Your perspective) \n\nEveryone has a standpoint or perspective that influences how they perceive the world. Rather than pretend that our standpoint is neutral, it is important to recognize it and how it might limit our ability to perceive the potential harms or benefits of our analyses.\n\na. Identify two aspects of your life experience that inform your standpoint or perspective. \n   i. **I have spent a significant portion of my adult life without a house or below the poverty line.**\n   ii. **I am a fat disabled woman in a world built on capitalist and patriarchal ideals that prioritize productivity, unattainable beauty standards, and masculine characteristics.**\nb. Identify how those two aspects of your life experience might limit your evaluation of future analyses.\n   i. **I will often assume the capitalists and those in power are the root cause of injustice.**\n   ii. **I may take on more than I can handle to stay ahead of those with more opportunity or privilege.**\nc. Identify how those two aspects of your life experience might benefit your evaluation of future analyses.\n   i. **I have a more nuanced understanding of the less obvious impacts of poverty.**\n   ii. **My perspective has less representation in previous researching offering a fresh approach.**\n\n## Exercise 10.4 (Neutrality?) \n\nThere are several instances in which data scientists might falsely consider themselves neutral. In this exercise, you will practice how to challenge the false idea of neutrality, an underappreciated skill for data scientists.\n\na. How would you respond if your colleague were to tell you “I’m just a neutral observer, so there’s no bias in my data analysis?”\nb. Your colleague now admits that they are not personally neutral, but they say “my model is neutral.” How do you respond to your colleague now?\nc. Give an example of when your personal experience or perspective has informed a data analysis.\n\n## Exercise 10.5 (That famous quote) \n\nGeorge Box famously said: “All models are wrong, but some are useful.” Write an explanation of what this quote means so that one of your non-statistical friends can understand.\n\n## Exercise 10.6 (Assumptions) \n\nProvide 3 assumptions of the Normal Bayesian linear regression model with $Y_i | \\beta_0, \\beta_1, \\sigma \\stackrel{ind}{\\sim} N(\\mu_i, \\sigma^2)$ where $\\mu_i = \\beta_0 + \\beta_1 X_i$.\n\n1. **Conditioned on $X$, the observed data $Y_i$ on case $i$ is independent of the observed data on any other case $j$.**\n2. **The typical $Y$ outcome can be written as a linear function of $X$0, $\\mu = \\beta_0 + \\beta_1 X$.**\n3. **At any $X$ value, $Y$ varies normally around $\\mu$ with consistent variability $\\sigma$.**\n\n## Exercise 10.7 (Mini posterior predictive check) \n\nSuppose we have a small dataset where predictor $X$ has values $\\vec{x} = (12, 10, 4, 8, 6)$, and response variable $Y$ has values $\\vec{y} = (20, 17, 4, 11, 9)$. Based on this data, we built a Bayesian linear regression model of $Y$ vs $X$.\n\na. In our first simulated parameter set, $\\left(\\beta_0^{(1)}, \\beta_1^{(1)}, \\sigma^{(1)} \\right) = (-1.8, 2.1, 0.8)$. Explain how you would use these values, combined with the data, to generate a prediction for $Y_1$.\nb. Using the first parameter set, generate predictions for $(Y_1, Y_2, \\ldots, Y_5)$. Comment on the difference between the predictions and the observed values $\\vec{y}$.\n   i. \n   \n```{r}\n\nx <- c(12,10,4,8,6)\ny <- c(20,17,4,11,9)\nsig <- .8\n\ndf <- data.frame(x = x, y = y, sig = sig)\n\n```\n\n``` {r, warning=FALSE, message=FALSE, results=FALSE, cache=TRUE}\n\ndf_model <- stan_glm(y ~ x, data = df,\n                     family = gaussian,\n                     prior_intercept = normal(5000, 1000),\n                     prior = normal(10, 5), \n                     prior_aux = exponential(0.8),\n                     chains = 4, iter = 5000*2, seed = 84735)\n\n# STEP 1: DEFINE the model\nstan_sample_model <- \"\n  data {\n    int<lower = 0> n;\n    vector[n] Y;\n    vector[n] X;\n  }\n  parameters {\n    real beta0;\n    real beta1;\n    real<lower = 0> sigma;\n  }\n  model {\n    Y ~ normal(beta0 + beta1 * X, sigma);\n    beta0 ~ normal(-2000, 1000);\n    beta1 ~ normal(100, 40);\n    sigma ~ exponential(0.0008);\n  }\n\"\n\n# STEP 2: SIMULATE the posterior\nstan_sample_sim <- \n  stan(model_code = stan_sample_model, \n       data = list(n = nrow(df), Y = df$y, X = df$x), \n       chains = 4, iter = 5000*2, seed = 84735)\n\n```\n\n``` {r}\n\ndf_model_df <- as.data.frame(df_model)\n\nfirst <- head(df_model_df, 1)\nfirst\n\nb0 <- first$`(Intercept)`\nb1 <- first$x\nsig  <- first$sigma\n\nset.seed(80085)\none_sim <- df %>%\n  mutate(mu = b0 + b1 * sig,\n         sim = rnorm(5, mean = mu, sd = sig)) %>%\n  select(x, y, sim)\n\npp_check(df_model, nreps = 50) + \n  xlab(\"x\")\n\n```\n\n## Exercise 10.8 (Explain to a friend: posterior predictive check) \n\nCongratulations! You have just completed a posterior predictive check for your regression model. Your friend Shefali has a lot of questions about this. Explain the following to Shefali in plain language:\n\na. The goal of a posterior predictive check.\nb. How to interpret the posterior predictive check results.\n\n## Exercise 10.9 (Explain to a friend: posterior predictive summary) \n\nShefali really appreciated your explanations from the previous exercise. She now wants you to explain posterior predictive summaries. Explain the following in plain language:\n\na. What the median absolute error tells us about your model.\nb. What the scaled median absolute error is, and why it might be an improvement over median absolute error.\nc. What the within-50 statistic tells us about your model.\n\n## Exercise 10.10 (Posterior predictive checks)\n\na. In `pp_check()` plots, what does the darker density represent? What does a single lighter-colored density represent?\nb. If our model fits well, describe how its `pp_check()` will appear. Explain why a good fitting model will produce a plot like this.\nc. If our model fits poorly, describe how its `pp_check()` might appear.\n\n## Exercise 10.11 (Cross-validation and tacos) \n\nRecall this example from the chapter: *Suppose you want to open a new taco stand. You build all of your recipes around Reem, your friend who prefers that anchovies be a part of every meal. You test your latest “anchov-ladas” dish on her and it’s a hit.*\n\na. What is the “data” in this analogy?\nb. What is the “model” in this analogy?\nc. How could you use cross-validation to evaluate a new taco recipe?\nd. Why would cross-validation help you develop a successful recipe?\n\n## Exercise 10.12 (Cross-validation)\n\na. What are the four steps for the k-fold cross-validation algorithm?\nb. What problems can occur when you use the same exact data to train and test a model?\nc. What questions do you have about k-fold cross-validation?\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true,"format-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","toc":true,"output-file":"10_exercises.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.3.433","theme":"../custom.scss","title":"10: Evaluating Regression Models","editor_options":{"chunk_output_type":"console"}},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}