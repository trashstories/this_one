{
  "hash": "a39b47b5bf61e457a79aecb606fac10e",
  "result": {
    "markdown": "---\ntitle: \"18: Non-Normal Hierarchical Regression & Classification\"\neditor_options: \n  chunk_output_type: console\n---\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load packages\nlibrary(bayesrules)\nlibrary(tidyverse)\nlibrary(bayesplot)\nlibrary(rstanarm)\nlibrary(tidybayes)\nlibrary(broom.mixed)\nlibrary(janitor)\n```\n:::\n\n\n# 18.1 Hierarchical logistic regression\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Import, rename, & clean data\ndata(climbers_sub)\nclimbers <- climbers_sub %>% \n  select(expedition_id, member_id, success, year, season,\n         age, expedition_role, oxygen_used)\n\nnrow(climbers)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 2076\n```\n:::\n\n```{.r .cell-code}\nclimbers %>% \n  tabyl(success)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n success    n   percent\n   FALSE 1269 0.6112717\n    TRUE  807 0.3887283\n```\n:::\n\n```{.r .cell-code}\n# Size per expedition\nclimbers_per_expedition <- climbers %>% \n  group_by(expedition_id) %>% \n  summarize(count = n())\n\n# Number of expeditions\nnrow(climbers_per_expedition)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 200\n```\n:::\n\n```{.r .cell-code}\nclimbers_per_expedition %>% \n  head(3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 3 × 2\n  expedition_id count\n  <chr>         <int>\n1 AMAD03107         5\n2 AMAD03327         6\n3 AMAD05338        12\n```\n:::\n\n```{.r .cell-code}\n# Calculate the success rate for each exhibition\nexpedition_success <- climbers %>% \n  group_by(expedition_id) %>% \n  summarize(success_rate = mean(success))\n\n# Plot the success rates across exhibitions\nggplot(expedition_success, aes(x = success_rate)) + \n  geom_histogram(color = \"white\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n```\n:::\n\n::: {.cell-output-display}\n![](18_notes_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\n## 18.1.1 Model building & simulation\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Calculate the success rate by age and oxygen use\ndata_by_age_oxygen <- climbers %>% \n  group_by(age, oxygen_used) %>% \n  summarize(success_rate = mean(success))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`summarise()` has grouped output by 'age'. You can override using the `.groups`\nargument.\n```\n:::\n\n```{.r .cell-code}\n# Plot this relationship\nggplot(data_by_age_oxygen, aes(x = age, y = success_rate, \n                               color = oxygen_used)) + \n  geom_point()\n```\n\n::: {.cell-output-display}\n![](18_notes_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n\n```{.r .cell-code}\nclimb_model <- stan_glmer(\n  success ~ age + oxygen_used + (1 | expedition_id), \n  data = climbers, family = binomial,\n  prior_intercept = normal(0, 2.5, autoscale = TRUE),\n  prior = normal(0, 2.5, autoscale = TRUE), \n  prior_covariance = decov(reg = 1, conc = 1, shape = 1, scale = 1),\n  chains = 4, iter = 5000*2, seed = 84735\n)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nSAMPLING FOR MODEL 'bernoulli' NOW (CHAIN 1).\nChain 1: \nChain 1: Gradient evaluation took 0.000943 seconds\nChain 1: 1000 transitions using 10 leapfrog steps per transition would take 9.43 seconds.\nChain 1: Adjust your expectations accordingly!\nChain 1: \nChain 1: \nChain 1: Iteration:    1 / 10000 [  0%]  (Warmup)\nChain 1: Iteration: 1000 / 10000 [ 10%]  (Warmup)\nChain 1: Iteration: 2000 / 10000 [ 20%]  (Warmup)\nChain 1: Iteration: 3000 / 10000 [ 30%]  (Warmup)\nChain 1: Iteration: 4000 / 10000 [ 40%]  (Warmup)\nChain 1: Iteration: 5000 / 10000 [ 50%]  (Warmup)\nChain 1: Iteration: 5001 / 10000 [ 50%]  (Sampling)\nChain 1: Iteration: 6000 / 10000 [ 60%]  (Sampling)\nChain 1: Iteration: 7000 / 10000 [ 70%]  (Sampling)\nChain 1: Iteration: 8000 / 10000 [ 80%]  (Sampling)\nChain 1: Iteration: 9000 / 10000 [ 90%]  (Sampling)\nChain 1: Iteration: 10000 / 10000 [100%]  (Sampling)\nChain 1: \nChain 1:  Elapsed Time: 103.159 seconds (Warm-up)\nChain 1:                94.927 seconds (Sampling)\nChain 1:                198.086 seconds (Total)\nChain 1: \n\nSAMPLING FOR MODEL 'bernoulli' NOW (CHAIN 2).\nChain 2: \nChain 2: Gradient evaluation took 0.000594 seconds\nChain 2: 1000 transitions using 10 leapfrog steps per transition would take 5.94 seconds.\nChain 2: Adjust your expectations accordingly!\nChain 2: \nChain 2: \nChain 2: Iteration:    1 / 10000 [  0%]  (Warmup)\nChain 2: Iteration: 1000 / 10000 [ 10%]  (Warmup)\nChain 2: Iteration: 2000 / 10000 [ 20%]  (Warmup)\nChain 2: Iteration: 3000 / 10000 [ 30%]  (Warmup)\nChain 2: Iteration: 4000 / 10000 [ 40%]  (Warmup)\nChain 2: Iteration: 5000 / 10000 [ 50%]  (Warmup)\nChain 2: Iteration: 5001 / 10000 [ 50%]  (Sampling)\nChain 2: Iteration: 6000 / 10000 [ 60%]  (Sampling)\nChain 2: Iteration: 7000 / 10000 [ 70%]  (Sampling)\nChain 2: Iteration: 8000 / 10000 [ 80%]  (Sampling)\nChain 2: Iteration: 9000 / 10000 [ 90%]  (Sampling)\nChain 2: Iteration: 10000 / 10000 [100%]  (Sampling)\nChain 2: \nChain 2:  Elapsed Time: 102.119 seconds (Warm-up)\nChain 2:                95.098 seconds (Sampling)\nChain 2:                197.217 seconds (Total)\nChain 2: \n\nSAMPLING FOR MODEL 'bernoulli' NOW (CHAIN 3).\nChain 3: \nChain 3: Gradient evaluation took 0.000586 seconds\nChain 3: 1000 transitions using 10 leapfrog steps per transition would take 5.86 seconds.\nChain 3: Adjust your expectations accordingly!\nChain 3: \nChain 3: \nChain 3: Iteration:    1 / 10000 [  0%]  (Warmup)\nChain 3: Iteration: 1000 / 10000 [ 10%]  (Warmup)\nChain 3: Iteration: 2000 / 10000 [ 20%]  (Warmup)\nChain 3: Iteration: 3000 / 10000 [ 30%]  (Warmup)\nChain 3: Iteration: 4000 / 10000 [ 40%]  (Warmup)\nChain 3: Iteration: 5000 / 10000 [ 50%]  (Warmup)\nChain 3: Iteration: 5001 / 10000 [ 50%]  (Sampling)\nChain 3: Iteration: 6000 / 10000 [ 60%]  (Sampling)\nChain 3: Iteration: 7000 / 10000 [ 70%]  (Sampling)\nChain 3: Iteration: 8000 / 10000 [ 80%]  (Sampling)\nChain 3: Iteration: 9000 / 10000 [ 90%]  (Sampling)\nChain 3: Iteration: 10000 / 10000 [100%]  (Sampling)\nChain 3: \nChain 3:  Elapsed Time: 104.297 seconds (Warm-up)\nChain 3:                94.916 seconds (Sampling)\nChain 3:                199.213 seconds (Total)\nChain 3: \n\nSAMPLING FOR MODEL 'bernoulli' NOW (CHAIN 4).\nChain 4: \nChain 4: Gradient evaluation took 0.000567 seconds\nChain 4: 1000 transitions using 10 leapfrog steps per transition would take 5.67 seconds.\nChain 4: Adjust your expectations accordingly!\nChain 4: \nChain 4: \nChain 4: Iteration:    1 / 10000 [  0%]  (Warmup)\nChain 4: Iteration: 1000 / 10000 [ 10%]  (Warmup)\nChain 4: Iteration: 2000 / 10000 [ 20%]  (Warmup)\nChain 4: Iteration: 3000 / 10000 [ 30%]  (Warmup)\nChain 4: Iteration: 4000 / 10000 [ 40%]  (Warmup)\nChain 4: Iteration: 5000 / 10000 [ 50%]  (Warmup)\nChain 4: Iteration: 5001 / 10000 [ 50%]  (Sampling)\nChain 4: Iteration: 6000 / 10000 [ 60%]  (Sampling)\nChain 4: Iteration: 7000 / 10000 [ 70%]  (Sampling)\nChain 4: Iteration: 8000 / 10000 [ 80%]  (Sampling)\nChain 4: Iteration: 9000 / 10000 [ 90%]  (Sampling)\nChain 4: Iteration: 10000 / 10000 [100%]  (Sampling)\nChain 4: \nChain 4:  Elapsed Time: 102.833 seconds (Warm-up)\nChain 4:                94.949 seconds (Sampling)\nChain 4:                197.782 seconds (Total)\nChain 4: \n```\n:::\n\n```{.r .cell-code}\n# Confirm prior specifications\nprior_summary(climb_model)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nPriors for model 'climb_model' \n------\nIntercept (after predictors centered)\n ~ normal(location = 0, scale = 2.5)\n\nCoefficients\n  Specified prior:\n    ~ normal(location = [0,0], scale = [2.5,2.5])\n  Adjusted prior:\n    ~ normal(location = [0,0], scale = [0.24,5.51])\n\nCovariance\n ~ decov(reg. = 1, conc. = 1, shape = 1, scale = 1)\n------\nSee help('prior_summary.stanreg') for more details\n```\n:::\n\n```{.r .cell-code}\n# MCMC diagnostics\nmcmc_trace(climb_model, size = 0.1)\n```\n\n::: {.cell-output-display}\n![](18_notes_files/figure-html/unnamed-chunk-3-2.png){width=672}\n:::\n\n```{.r .cell-code}\nmcmc_dens_overlay(climb_model)\n```\n\n::: {.cell-output-display}\n![](18_notes_files/figure-html/unnamed-chunk-3-3.png){width=672}\n:::\n\n```{.r .cell-code}\nmcmc_acf(climb_model)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: The `facets` argument of `facet_grid()` is deprecated as of ggplot2 2.2.0.\nℹ Please use the `rows` argument instead.\nℹ The deprecated feature was likely used in the bayesplot package.\n  Please report the issue at <https://github.com/stan-dev/bayesplot/issues/>.\n```\n:::\n\n::: {.cell-output-display}\n![](18_notes_files/figure-html/unnamed-chunk-3-4.png){width=672}\n:::\n\n```{.r .cell-code}\nneff_ratio(climb_model)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                                 (Intercept) \n                                     0.41160 \n                                         age \n                                     1.45620 \n                             oxygen_usedTRUE \n                                     0.43445 \n      b[(Intercept) expedition_id:AMAD03107] \n                                     0.99290 \n      b[(Intercept) expedition_id:AMAD03327] \n                                     0.95750 \n      b[(Intercept) expedition_id:AMAD05338] \n                                     0.70125 \n      b[(Intercept) expedition_id:AMAD06110] \n                                     1.19820 \n      b[(Intercept) expedition_id:AMAD06334] \n                                     1.11335 \n      b[(Intercept) expedition_id:AMAD07101] \n                                     1.01905 \n      b[(Intercept) expedition_id:AMAD07310] \n                                     0.66385 \n      b[(Intercept) expedition_id:AMAD07337] \n                                     0.82665 \n      b[(Intercept) expedition_id:AMAD07340] \n                                     0.69380 \n      b[(Intercept) expedition_id:AMAD09331] \n                                     1.05840 \n      b[(Intercept) expedition_id:AMAD09333] \n                                     0.92550 \n      b[(Intercept) expedition_id:AMAD11304] \n                                     0.98605 \n      b[(Intercept) expedition_id:AMAD11321] \n                                     0.86985 \n      b[(Intercept) expedition_id:AMAD11340] \n                                     0.91255 \n      b[(Intercept) expedition_id:AMAD12108] \n                                     1.04960 \n      b[(Intercept) expedition_id:AMAD12342] \n                                     0.95040 \n      b[(Intercept) expedition_id:AMAD14105] \n                                     1.16925 \n      b[(Intercept) expedition_id:AMAD14322] \n                                     0.72025 \n      b[(Intercept) expedition_id:AMAD16354] \n                                     1.03215 \n      b[(Intercept) expedition_id:AMAD17307] \n                                     0.91265 \n      b[(Intercept) expedition_id:AMAD81101] \n                                     0.81000 \n      b[(Intercept) expedition_id:AMAD84401] \n                                     1.13570 \n      b[(Intercept) expedition_id:AMAD89102] \n                                     1.02590 \n      b[(Intercept) expedition_id:AMAD93304] \n                                     0.95495 \n      b[(Intercept) expedition_id:AMAD98311] \n                                     0.88570 \n      b[(Intercept) expedition_id:AMAD98316] \n                                     0.65545 \n      b[(Intercept) expedition_id:AMAD98402] \n                                     1.13445 \n      b[(Intercept) expedition_id:ANN115106] \n                                     1.14500 \n      b[(Intercept) expedition_id:ANN115108] \n                                     1.12405 \n      b[(Intercept) expedition_id:ANN179301] \n                                     1.03035 \n      b[(Intercept) expedition_id:ANN185401] \n                                     0.93895 \n      b[(Intercept) expedition_id:ANN190101] \n                                     1.04835 \n      b[(Intercept) expedition_id:ANN193302] \n                                     1.02980 \n      b[(Intercept) expedition_id:ANN281302] \n                                     1.10675 \n      b[(Intercept) expedition_id:ANN283302] \n                                     1.10030 \n      b[(Intercept) expedition_id:ANN378301] \n                                     0.98820 \n      b[(Intercept) expedition_id:ANN402302] \n                                     1.14060 \n      b[(Intercept) expedition_id:ANN405301] \n                                     1.21280 \n      b[(Intercept) expedition_id:ANN409201] \n                                     0.92035 \n      b[(Intercept) expedition_id:ANN416101] \n                                     1.14655 \n      b[(Intercept) expedition_id:BARU01304] \n                                     1.20590 \n      b[(Intercept) expedition_id:BARU02101] \n                                     1.08000 \n      b[(Intercept) expedition_id:BARU02303] \n                                     1.00730 \n      b[(Intercept) expedition_id:BARU09102] \n                                     1.15665 \n      b[(Intercept) expedition_id:BARU10312] \n                                     1.01370 \n      b[(Intercept) expedition_id:BARU11303] \n                                     0.68275 \n      b[(Intercept) expedition_id:BARU92301] \n                                     0.74580 \n      b[(Intercept) expedition_id:BARU94301] \n                                     1.20785 \n      b[(Intercept) expedition_id:BARU94307] \n                                     1.05735 \n      b[(Intercept) expedition_id:BHRI86101] \n                                     1.10570 \n      b[(Intercept) expedition_id:CHAM18101] \n                                     1.22790 \n      b[(Intercept) expedition_id:CHAM91301] \n                                     0.68310 \n      b[(Intercept) expedition_id:CHOY02117] \n                                     0.90405 \n      b[(Intercept) expedition_id:CHOY03103] \n                                     0.95280 \n      b[(Intercept) expedition_id:CHOY03318] \n                                     0.46565 \n      b[(Intercept) expedition_id:CHOY04122] \n                                     0.77255 \n      b[(Intercept) expedition_id:CHOY04302] \n                                     0.95880 \n      b[(Intercept) expedition_id:CHOY06330] \n                                     1.12315 \n      b[(Intercept) expedition_id:CHOY07310] \n                                     0.87840 \n      b[(Intercept) expedition_id:CHOY07330] \n                                     1.06040 \n      b[(Intercept) expedition_id:CHOY07356] \n                                     1.12765 \n      b[(Intercept) expedition_id:CHOY07358] \n                                     0.78135 \n      b[(Intercept) expedition_id:CHOY10328] \n                                     1.13265 \n      b[(Intercept) expedition_id:CHOY10341] \n                                     1.09580 \n      b[(Intercept) expedition_id:CHOY93304] \n                                     1.05540 \n      b[(Intercept) expedition_id:CHOY96319] \n                                     0.79310 \n      b[(Intercept) expedition_id:CHOY97103] \n                                     0.76350 \n      b[(Intercept) expedition_id:CHOY98307] \n                                     1.39710 \n      b[(Intercept) expedition_id:CHOY99301] \n                                     0.70325 \n      b[(Intercept) expedition_id:DHA109113] \n                                     1.26515 \n      b[(Intercept) expedition_id:DHA116106] \n                                     1.05875 \n      b[(Intercept) expedition_id:DHA183302] \n                                     1.10780 \n      b[(Intercept) expedition_id:DHA193302] \n                                     1.06170 \n      b[(Intercept) expedition_id:DHA196104] \n                                     1.16595 \n      b[(Intercept) expedition_id:DHA197107] \n                                     1.21660 \n      b[(Intercept) expedition_id:DHA197307] \n                                     1.13295 \n      b[(Intercept) expedition_id:DHA198107] \n                                     0.83905 \n      b[(Intercept) expedition_id:DHA198302] \n                                     1.17800 \n      b[(Intercept) expedition_id:DHAM88301] \n                                     1.10200 \n      b[(Intercept) expedition_id:DZA215301] \n                                     0.91800 \n      b[(Intercept) expedition_id:EVER00116] \n                                     1.04765 \n      b[(Intercept) expedition_id:EVER00148] \n                                     1.18775 \n      b[(Intercept) expedition_id:EVER01108] \n                                     0.71185 \n      b[(Intercept) expedition_id:EVER02112] \n                                     1.42520 \n      b[(Intercept) expedition_id:EVER03124] \n                                     1.24505 \n      b[(Intercept) expedition_id:EVER03168] \n                                     0.81270 \n      b[(Intercept) expedition_id:EVER04150] \n                                     1.23930 \n      b[(Intercept) expedition_id:EVER04156] \n                                     1.21020 \n      b[(Intercept) expedition_id:EVER06133] \n                                     0.73035 \n      b[(Intercept) expedition_id:EVER06136] \n                                     0.65125 \n      b[(Intercept) expedition_id:EVER06152] \n                                     1.29470 \n      b[(Intercept) expedition_id:EVER06163] \n                                     0.87275 \n      b[(Intercept) expedition_id:EVER07107] \n                                     1.20930 \n      b[(Intercept) expedition_id:EVER07148] \n                                     0.84460 \n      b[(Intercept) expedition_id:EVER07175] \n                                     0.81290 \n      b[(Intercept) expedition_id:EVER07192] \n                                     1.00945 \n      b[(Intercept) expedition_id:EVER07194] \n                                     0.93260 \n      b[(Intercept) expedition_id:EVER08139] \n                                     0.43690 \n      b[(Intercept) expedition_id:EVER08152] \n                                     0.83350 \n      b[(Intercept) expedition_id:EVER08154] \n                                     1.21480 \n      b[(Intercept) expedition_id:EVER10121] \n                                     1.07825 \n      b[(Intercept) expedition_id:EVER10136] \n                                     1.04760 \n      b[(Intercept) expedition_id:EVER10154] \n                                     0.48955 \n      b[(Intercept) expedition_id:EVER11103] \n                                     0.52590 \n      b[(Intercept) expedition_id:EVER11134] \n                                     0.91985 \n      b[(Intercept) expedition_id:EVER11144] \n                                     1.00785 \n      b[(Intercept) expedition_id:EVER11152] \n                                     0.91365 \n      b[(Intercept) expedition_id:EVER12133] \n                                     1.03955 \n      b[(Intercept) expedition_id:EVER12141] \n                                     1.23355 \n      b[(Intercept) expedition_id:EVER14138] \n                                     1.13230 \n      b[(Intercept) expedition_id:EVER14165] \n                                     1.23150 \n      b[(Intercept) expedition_id:EVER15117] \n                                     1.04265 \n      b[(Intercept) expedition_id:EVER15123] \n                                     1.01625 \n      b[(Intercept) expedition_id:EVER16105] \n                                     0.48960 \n      b[(Intercept) expedition_id:EVER17123] \n                                     0.52775 \n      b[(Intercept) expedition_id:EVER17137] \n                                     1.17155 \n      b[(Intercept) expedition_id:EVER18118] \n                                     0.93575 \n      b[(Intercept) expedition_id:EVER18132] \n                                     1.37140 \n      b[(Intercept) expedition_id:EVER19104] \n                                     0.98055 \n      b[(Intercept) expedition_id:EVER19112] \n                                     0.86200 \n      b[(Intercept) expedition_id:EVER19120] \n                                     0.94400 \n      b[(Intercept) expedition_id:EVER81101] \n                                     1.30095 \n      b[(Intercept) expedition_id:EVER86101] \n                                     1.08810 \n      b[(Intercept) expedition_id:EVER89304] \n                                     1.03440 \n      b[(Intercept) expedition_id:EVER91108] \n                                     1.10480 \n      b[(Intercept) expedition_id:EVER96302] \n                                     1.14030 \n      b[(Intercept) expedition_id:EVER97105] \n                                     1.05000 \n      b[(Intercept) expedition_id:EVER98116] \n                                     0.87110 \n      b[(Intercept) expedition_id:EVER99107] \n                                     1.14300 \n      b[(Intercept) expedition_id:EVER99113] \n                                     0.92845 \n      b[(Intercept) expedition_id:EVER99116] \n                                     1.04940 \n      b[(Intercept) expedition_id:FANG97301] \n                                     1.10150 \n      b[(Intercept) expedition_id:GAN379301] \n                                     0.94560 \n      b[(Intercept) expedition_id:GAUR83101] \n                                     1.01270 \n      b[(Intercept) expedition_id:GURK03301] \n                                     1.14615 \n      b[(Intercept) expedition_id:GYAJ15101] \n                                     1.17865 \n      b[(Intercept) expedition_id:HIML03302] \n                                     0.89170 \n      b[(Intercept) expedition_id:HIML08301] \n                                     0.77525 \n      b[(Intercept) expedition_id:HIML08307] \n                                     1.12470 \n      b[(Intercept) expedition_id:HIML13303] \n                                     0.83955 \n      b[(Intercept) expedition_id:HIML13305] \n                                     1.20015 \n      b[(Intercept) expedition_id:HIML18310] \n                                     0.95445 \n      b[(Intercept) expedition_id:JANU02401] \n                                     1.09540 \n      b[(Intercept) expedition_id:JANU89401] \n                                     1.06280 \n      b[(Intercept) expedition_id:JANU97301] \n                                     1.16300 \n      b[(Intercept) expedition_id:JANU98102] \n                                     1.18135 \n      b[(Intercept) expedition_id:JETH78101] \n                                     1.13330 \n      b[(Intercept) expedition_id:KABD85101] \n                                     0.90315 \n      b[(Intercept) expedition_id:KAN180101] \n                                     1.16700 \n      b[(Intercept) expedition_id:KANG81101] \n                                     0.86255 \n      b[(Intercept) expedition_id:KANG94301] \n                                     1.06450 \n      b[(Intercept) expedition_id:KWAN82402] \n                                     0.92555 \n      b[(Intercept) expedition_id:LANG84101] \n                                     1.00725 \n      b[(Intercept) expedition_id:LEOE05301] \n                                     1.11545 \n      b[(Intercept) expedition_id:LHOT09108] \n                                     1.37755 \n      b[(Intercept) expedition_id:LHOT88301] \n                                     1.65335 \n      b[(Intercept) expedition_id:LNJU16301] \n                                     1.15105 \n      b[(Intercept) expedition_id:LSHR90301] \n                                     0.84435 \n      b[(Intercept) expedition_id:MAKA01104] \n                                     1.08020 \n      b[(Intercept) expedition_id:MAKA02102] \n                                     0.86155 \n      b[(Intercept) expedition_id:MAKA02103] \n                                     0.83305 \n      b[(Intercept) expedition_id:MAKA08112] \n                                     1.03440 \n      b[(Intercept) expedition_id:MAKA09108] \n                                     1.27195 \n      b[(Intercept) expedition_id:MAKA15106] \n                                     1.07695 \n      b[(Intercept) expedition_id:MAKA90306] \n                                     1.08685 \n      b[(Intercept) expedition_id:MANA06305] \n                                     1.14845 \n      b[(Intercept) expedition_id:MANA08324] \n                                     0.91725 \n      b[(Intercept) expedition_id:MANA09107] \n                                     1.01235 \n      b[(Intercept) expedition_id:MANA10319] \n                                     0.65330 \n      b[(Intercept) expedition_id:MANA11106] \n                                     1.14100 \n      b[(Intercept) expedition_id:MANA11318] \n                                     1.23055 \n      b[(Intercept) expedition_id:MANA17333] \n                                     1.43545 \n      b[(Intercept) expedition_id:MANA18306] \n                                     0.79665 \n      b[(Intercept) expedition_id:MANA80101] \n                                     1.39505 \n      b[(Intercept) expedition_id:MANA82401] \n                                     0.95900 \n      b[(Intercept) expedition_id:MANA84101] \n                                     0.85755 \n      b[(Intercept) expedition_id:MANA91301] \n                                     1.06685 \n      b[(Intercept) expedition_id:MANA97301] \n                                     0.64550 \n      b[(Intercept) expedition_id:NAMP79101] \n                                     1.05900 \n      b[(Intercept) expedition_id:NEMJ83101] \n                                     1.00295 \n      b[(Intercept) expedition_id:NILC79101] \n                                     0.94890 \n      b[(Intercept) expedition_id:NUPT99102] \n                                     1.18375 \n      b[(Intercept) expedition_id:OHMI89101] \n                                     0.79975 \n      b[(Intercept) expedition_id:PUMO06301] \n                                     1.04300 \n      b[(Intercept) expedition_id:PUMO80302] \n                                     1.03890 \n      b[(Intercept) expedition_id:PUMO92308] \n                                     0.91235 \n      b[(Intercept) expedition_id:PUMO96101] \n                                     0.82615 \n      b[(Intercept) expedition_id:PUTH02301] \n                                     0.85185 \n      b[(Intercept) expedition_id:PUTH97302] \n                                     1.11355 \n      b[(Intercept) expedition_id:SHAL05301] \n                                     1.14565 \n      b[(Intercept) expedition_id:SPHN93101] \n                                     0.93955 \n      b[(Intercept) expedition_id:SYKG12301] \n                                     0.97980 \n      b[(Intercept) expedition_id:TAWO83101] \n                                     1.13505 \n      b[(Intercept) expedition_id:TILI04301] \n                                     1.10680 \n      b[(Intercept) expedition_id:TILI05301] \n                                     0.57850 \n      b[(Intercept) expedition_id:TILI91302] \n                                     0.80920 \n      b[(Intercept) expedition_id:TILI92301] \n                                     1.04880 \n      b[(Intercept) expedition_id:TKPO02102] \n                                     1.01510 \n      b[(Intercept) expedition_id:TUKU05101] \n                                     1.14140 \n      b[(Intercept) expedition_id:TUKU16301] \n                                     0.86765 \nSigma[expedition_id:(Intercept),(Intercept)] \n                                     0.29880 \n```\n:::\n\n```{.r .cell-code}\nrhat(climb_model)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                                 (Intercept) \n                                   1.0004549 \n                                         age \n                                   0.9999924 \n                             oxygen_usedTRUE \n                                   0.9999663 \n      b[(Intercept) expedition_id:AMAD03107] \n                                   0.9999193 \n      b[(Intercept) expedition_id:AMAD03327] \n                                   0.9999572 \n      b[(Intercept) expedition_id:AMAD05338] \n                                   0.9999660 \n      b[(Intercept) expedition_id:AMAD06110] \n                                   1.0000149 \n      b[(Intercept) expedition_id:AMAD06334] \n                                   0.9998924 \n      b[(Intercept) expedition_id:AMAD07101] \n                                   0.9999625 \n      b[(Intercept) expedition_id:AMAD07310] \n                                   1.0001640 \n      b[(Intercept) expedition_id:AMAD07337] \n                                   1.0001060 \n      b[(Intercept) expedition_id:AMAD07340] \n                                   1.0002327 \n      b[(Intercept) expedition_id:AMAD09331] \n                                   1.0002215 \n      b[(Intercept) expedition_id:AMAD09333] \n                                   1.0000130 \n      b[(Intercept) expedition_id:AMAD11304] \n                                   1.0000319 \n      b[(Intercept) expedition_id:AMAD11321] \n                                   0.9999351 \n      b[(Intercept) expedition_id:AMAD11340] \n                                   0.9998827 \n      b[(Intercept) expedition_id:AMAD12108] \n                                   0.9998889 \n      b[(Intercept) expedition_id:AMAD12342] \n                                   0.9998834 \n      b[(Intercept) expedition_id:AMAD14105] \n                                   0.9999342 \n      b[(Intercept) expedition_id:AMAD14322] \n                                   1.0000045 \n      b[(Intercept) expedition_id:AMAD16354] \n                                   1.0000015 \n      b[(Intercept) expedition_id:AMAD17307] \n                                   1.0000843 \n      b[(Intercept) expedition_id:AMAD81101] \n                                   1.0000408 \n      b[(Intercept) expedition_id:AMAD84401] \n                                   0.9999276 \n      b[(Intercept) expedition_id:AMAD89102] \n                                   1.0000836 \n      b[(Intercept) expedition_id:AMAD93304] \n                                   0.9999663 \n      b[(Intercept) expedition_id:AMAD98311] \n                                   1.0000129 \n      b[(Intercept) expedition_id:AMAD98316] \n                                   1.0000406 \n      b[(Intercept) expedition_id:AMAD98402] \n                                   1.0000684 \n      b[(Intercept) expedition_id:ANN115106] \n                                   0.9999375 \n      b[(Intercept) expedition_id:ANN115108] \n                                   0.9999257 \n      b[(Intercept) expedition_id:ANN179301] \n                                   0.9999550 \n      b[(Intercept) expedition_id:ANN185401] \n                                   0.9999240 \n      b[(Intercept) expedition_id:ANN190101] \n                                   0.9999890 \n      b[(Intercept) expedition_id:ANN193302] \n                                   0.9999049 \n      b[(Intercept) expedition_id:ANN281302] \n                                   1.0000384 \n      b[(Intercept) expedition_id:ANN283302] \n                                   1.0000213 \n      b[(Intercept) expedition_id:ANN378301] \n                                   1.0000250 \n      b[(Intercept) expedition_id:ANN402302] \n                                   1.0000533 \n      b[(Intercept) expedition_id:ANN405301] \n                                   0.9998821 \n      b[(Intercept) expedition_id:ANN409201] \n                                   1.0000032 \n      b[(Intercept) expedition_id:ANN416101] \n                                   0.9999967 \n      b[(Intercept) expedition_id:BARU01304] \n                                   0.9998988 \n      b[(Intercept) expedition_id:BARU02101] \n                                   0.9998951 \n      b[(Intercept) expedition_id:BARU02303] \n                                   1.0001286 \n      b[(Intercept) expedition_id:BARU09102] \n                                   0.9999227 \n      b[(Intercept) expedition_id:BARU10312] \n                                   1.0001409 \n      b[(Intercept) expedition_id:BARU11303] \n                                   1.0000822 \n      b[(Intercept) expedition_id:BARU92301] \n                                   1.0001269 \n      b[(Intercept) expedition_id:BARU94301] \n                                   0.9999564 \n      b[(Intercept) expedition_id:BARU94307] \n                                   1.0001719 \n      b[(Intercept) expedition_id:BHRI86101] \n                                   0.9998877 \n      b[(Intercept) expedition_id:CHAM18101] \n                                   0.9999351 \n      b[(Intercept) expedition_id:CHAM91301] \n                                   1.0001714 \n      b[(Intercept) expedition_id:CHOY02117] \n                                   1.0001794 \n      b[(Intercept) expedition_id:CHOY03103] \n                                   1.0003105 \n      b[(Intercept) expedition_id:CHOY03318] \n                                   0.9999218 \n      b[(Intercept) expedition_id:CHOY04122] \n                                   0.9999430 \n      b[(Intercept) expedition_id:CHOY04302] \n                                   0.9998766 \n      b[(Intercept) expedition_id:CHOY06330] \n                                   1.0000411 \n      b[(Intercept) expedition_id:CHOY07310] \n                                   1.0001105 \n      b[(Intercept) expedition_id:CHOY07330] \n                                   1.0000059 \n      b[(Intercept) expedition_id:CHOY07356] \n                                   0.9999314 \n      b[(Intercept) expedition_id:CHOY07358] \n                                   1.0002763 \n      b[(Intercept) expedition_id:CHOY10328] \n                                   0.9999189 \n      b[(Intercept) expedition_id:CHOY10341] \n                                   0.9999972 \n      b[(Intercept) expedition_id:CHOY93304] \n                                   0.9998819 \n      b[(Intercept) expedition_id:CHOY96319] \n                                   0.9999708 \n      b[(Intercept) expedition_id:CHOY97103] \n                                   0.9999174 \n      b[(Intercept) expedition_id:CHOY98307] \n                                   1.0000131 \n      b[(Intercept) expedition_id:CHOY99301] \n                                   1.0000811 \n      b[(Intercept) expedition_id:DHA109113] \n                                   0.9999048 \n      b[(Intercept) expedition_id:DHA116106] \n                                   1.0002096 \n      b[(Intercept) expedition_id:DHA183302] \n                                   0.9998304 \n      b[(Intercept) expedition_id:DHA193302] \n                                   1.0000431 \n      b[(Intercept) expedition_id:DHA196104] \n                                   0.9998573 \n      b[(Intercept) expedition_id:DHA197107] \n                                   1.0000778 \n      b[(Intercept) expedition_id:DHA197307] \n                                   1.0000350 \n      b[(Intercept) expedition_id:DHA198107] \n                                   1.0000068 \n      b[(Intercept) expedition_id:DHA198302] \n                                   0.9999150 \n      b[(Intercept) expedition_id:DHAM88301] \n                                   0.9998816 \n      b[(Intercept) expedition_id:DZA215301] \n                                   0.9999569 \n      b[(Intercept) expedition_id:EVER00116] \n                                   0.9998926 \n      b[(Intercept) expedition_id:EVER00148] \n                                   0.9999979 \n      b[(Intercept) expedition_id:EVER01108] \n                                   0.9998373 \n      b[(Intercept) expedition_id:EVER02112] \n                                   0.9999940 \n      b[(Intercept) expedition_id:EVER03124] \n                                   0.9999154 \n      b[(Intercept) expedition_id:EVER03168] \n                                   0.9999276 \n      b[(Intercept) expedition_id:EVER04150] \n                                   0.9999130 \n      b[(Intercept) expedition_id:EVER04156] \n                                   0.9999532 \n      b[(Intercept) expedition_id:EVER06133] \n                                   0.9999389 \n      b[(Intercept) expedition_id:EVER06136] \n                                   0.9999254 \n      b[(Intercept) expedition_id:EVER06152] \n                                   0.9998618 \n      b[(Intercept) expedition_id:EVER06163] \n                                   0.9998893 \n      b[(Intercept) expedition_id:EVER07107] \n                                   0.9999050 \n      b[(Intercept) expedition_id:EVER07148] \n                                   0.9998537 \n      b[(Intercept) expedition_id:EVER07175] \n                                   0.9999722 \n      b[(Intercept) expedition_id:EVER07192] \n                                   0.9999251 \n      b[(Intercept) expedition_id:EVER07194] \n                                   0.9999139 \n      b[(Intercept) expedition_id:EVER08139] \n                                   0.9999283 \n      b[(Intercept) expedition_id:EVER08152] \n                                   0.9998295 \n      b[(Intercept) expedition_id:EVER08154] \n                                   1.0000157 \n      b[(Intercept) expedition_id:EVER10121] \n                                   0.9998860 \n      b[(Intercept) expedition_id:EVER10136] \n                                   0.9998483 \n      b[(Intercept) expedition_id:EVER10154] \n                                   0.9999208 \n      b[(Intercept) expedition_id:EVER11103] \n                                   0.9999682 \n      b[(Intercept) expedition_id:EVER11134] \n                                   0.9999340 \n      b[(Intercept) expedition_id:EVER11144] \n                                   0.9999076 \n      b[(Intercept) expedition_id:EVER11152] \n                                   1.0000394 \n      b[(Intercept) expedition_id:EVER12133] \n                                   0.9998958 \n      b[(Intercept) expedition_id:EVER12141] \n                                   0.9999311 \n      b[(Intercept) expedition_id:EVER14138] \n                                   0.9999660 \n      b[(Intercept) expedition_id:EVER14165] \n                                   0.9999144 \n      b[(Intercept) expedition_id:EVER15117] \n                                   0.9999796 \n      b[(Intercept) expedition_id:EVER15123] \n                                   1.0001197 \n      b[(Intercept) expedition_id:EVER16105] \n                                   0.9998389 \n      b[(Intercept) expedition_id:EVER17123] \n                                   0.9999565 \n      b[(Intercept) expedition_id:EVER17137] \n                                   0.9999394 \n      b[(Intercept) expedition_id:EVER18118] \n                                   0.9999516 \n      b[(Intercept) expedition_id:EVER18132] \n                                   0.9998940 \n      b[(Intercept) expedition_id:EVER19104] \n                                   0.9998372 \n      b[(Intercept) expedition_id:EVER19112] \n                                   1.0000177 \n      b[(Intercept) expedition_id:EVER19120] \n                                   1.0004140 \n      b[(Intercept) expedition_id:EVER81101] \n                                   0.9998716 \n      b[(Intercept) expedition_id:EVER86101] \n                                   0.9998738 \n      b[(Intercept) expedition_id:EVER89304] \n                                   0.9998638 \n      b[(Intercept) expedition_id:EVER91108] \n                                   1.0002497 \n      b[(Intercept) expedition_id:EVER96302] \n                                   0.9999122 \n      b[(Intercept) expedition_id:EVER97105] \n                                   0.9999736 \n      b[(Intercept) expedition_id:EVER98116] \n                                   1.0000469 \n      b[(Intercept) expedition_id:EVER99107] \n                                   1.0001298 \n      b[(Intercept) expedition_id:EVER99113] \n                                   0.9998858 \n      b[(Intercept) expedition_id:EVER99116] \n                                   1.0000132 \n      b[(Intercept) expedition_id:FANG97301] \n                                   1.0000678 \n      b[(Intercept) expedition_id:GAN379301] \n                                   0.9999367 \n      b[(Intercept) expedition_id:GAUR83101] \n                                   1.0001034 \n      b[(Intercept) expedition_id:GURK03301] \n                                   0.9999400 \n      b[(Intercept) expedition_id:GYAJ15101] \n                                   1.0001710 \n      b[(Intercept) expedition_id:HIML03302] \n                                   1.0000818 \n      b[(Intercept) expedition_id:HIML08301] \n                                   1.0000192 \n      b[(Intercept) expedition_id:HIML08307] \n                                   1.0000316 \n      b[(Intercept) expedition_id:HIML13303] \n                                   1.0000277 \n      b[(Intercept) expedition_id:HIML13305] \n                                   1.0001497 \n      b[(Intercept) expedition_id:HIML18310] \n                                   1.0000910 \n      b[(Intercept) expedition_id:JANU02401] \n                                   1.0001110 \n      b[(Intercept) expedition_id:JANU89401] \n                                   0.9999627 \n      b[(Intercept) expedition_id:JANU97301] \n                                   0.9999976 \n      b[(Intercept) expedition_id:JANU98102] \n                                   1.0004115 \n      b[(Intercept) expedition_id:JETH78101] \n                                   0.9999835 \n      b[(Intercept) expedition_id:KABD85101] \n                                   1.0001324 \n      b[(Intercept) expedition_id:KAN180101] \n                                   1.0000451 \n      b[(Intercept) expedition_id:KANG81101] \n                                   1.0001184 \n      b[(Intercept) expedition_id:KANG94301] \n                                   1.0000855 \n      b[(Intercept) expedition_id:KWAN82402] \n                                   1.0001556 \n      b[(Intercept) expedition_id:LANG84101] \n                                   1.0000996 \n      b[(Intercept) expedition_id:LEOE05301] \n                                   0.9998494 \n      b[(Intercept) expedition_id:LHOT09108] \n                                   0.9999030 \n      b[(Intercept) expedition_id:LHOT88301] \n                                   0.9999018 \n      b[(Intercept) expedition_id:LNJU16301] \n                                   0.9999432 \n      b[(Intercept) expedition_id:LSHR90301] \n                                   1.0001253 \n      b[(Intercept) expedition_id:MAKA01104] \n                                   0.9999824 \n      b[(Intercept) expedition_id:MAKA02102] \n                                   1.0000229 \n      b[(Intercept) expedition_id:MAKA02103] \n                                   1.0000083 \n      b[(Intercept) expedition_id:MAKA08112] \n                                   1.0000281 \n      b[(Intercept) expedition_id:MAKA09108] \n                                   1.0001418 \n      b[(Intercept) expedition_id:MAKA15106] \n                                   0.9999748 \n      b[(Intercept) expedition_id:MAKA90306] \n                                   0.9999178 \n      b[(Intercept) expedition_id:MANA06305] \n                                   0.9998634 \n      b[(Intercept) expedition_id:MANA08324] \n                                   0.9998966 \n      b[(Intercept) expedition_id:MANA09107] \n                                   0.9999731 \n      b[(Intercept) expedition_id:MANA10319] \n                                   1.0002262 \n      b[(Intercept) expedition_id:MANA11106] \n                                   0.9998532 \n      b[(Intercept) expedition_id:MANA11318] \n                                   0.9999909 \n      b[(Intercept) expedition_id:MANA17333] \n                                   1.0000001 \n      b[(Intercept) expedition_id:MANA18306] \n                                   0.9998587 \n      b[(Intercept) expedition_id:MANA80101] \n                                   0.9998988 \n      b[(Intercept) expedition_id:MANA82401] \n                                   1.0000874 \n      b[(Intercept) expedition_id:MANA84101] \n                                   1.0001541 \n      b[(Intercept) expedition_id:MANA91301] \n                                   0.9998898 \n      b[(Intercept) expedition_id:MANA97301] \n                                   1.0002380 \n      b[(Intercept) expedition_id:NAMP79101] \n                                   0.9998955 \n      b[(Intercept) expedition_id:NEMJ83101] \n                                   1.0000640 \n      b[(Intercept) expedition_id:NILC79101] \n                                   1.0000375 \n      b[(Intercept) expedition_id:NUPT99102] \n                                   1.0000267 \n      b[(Intercept) expedition_id:OHMI89101] \n                                   0.9999414 \n      b[(Intercept) expedition_id:PUMO06301] \n                                   0.9999963 \n      b[(Intercept) expedition_id:PUMO80302] \n                                   0.9998729 \n      b[(Intercept) expedition_id:PUMO92308] \n                                   0.9999186 \n      b[(Intercept) expedition_id:PUMO96101] \n                                   0.9999834 \n      b[(Intercept) expedition_id:PUTH02301] \n                                   1.0001114 \n      b[(Intercept) expedition_id:PUTH97302] \n                                   0.9998523 \n      b[(Intercept) expedition_id:SHAL05301] \n                                   0.9998872 \n      b[(Intercept) expedition_id:SPHN93101] \n                                   0.9999470 \n      b[(Intercept) expedition_id:SYKG12301] \n                                   1.0000304 \n      b[(Intercept) expedition_id:TAWO83101] \n                                   0.9999815 \n      b[(Intercept) expedition_id:TILI04301] \n                                   1.0001773 \n      b[(Intercept) expedition_id:TILI05301] \n                                   1.0002265 \n      b[(Intercept) expedition_id:TILI91302] \n                                   1.0000388 \n      b[(Intercept) expedition_id:TILI92301] \n                                   1.0000811 \n      b[(Intercept) expedition_id:TKPO02102] \n                                   0.9999243 \n      b[(Intercept) expedition_id:TUKU05101] \n                                   1.0000314 \n      b[(Intercept) expedition_id:TUKU16301] \n                                   0.9999695 \nSigma[expedition_id:(Intercept),(Intercept)] \n                                   1.0013979 \n```\n:::\n\n```{.r .cell-code}\n# Define success rate function\nsuccess_rate <- function(x){mean(x == 1)}\n\n# Posterior predictive check\npp_check(climb_model, nreps = 100,\n         plotfun = \"stat\", stat = \"success_rate\") + \n  xlab(\"success rate\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: 'nreps' is ignored for this PPC\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n```\n:::\n\n::: {.cell-output-display}\n![](18_notes_files/figure-html/unnamed-chunk-3-5.png){width=672}\n:::\n:::\n\n\n## 18.1.2 Posterior analysis\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntidy(climb_model, effects = \"fixed\", conf.int = TRUE, conf.level = 0.80)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 3 × 5\n  term            estimate std.error conf.low conf.high\n  <chr>              <dbl>     <dbl>    <dbl>     <dbl>\n1 (Intercept)      -1.40     0.480    -2.03     -0.801 \n2 age              -0.0475   0.00916  -0.0593   -0.0357\n3 oxygen_usedTRUE   5.79     0.483     5.21      6.44  \n```\n:::\n\n```{.r .cell-code}\nclimbers %>%\n  add_fitted_draws(climb_model, n = 100, re_formula = NA) %>%\n  ggplot(aes(x = age, y = success, color = oxygen_used)) +\n    geom_line(aes(y = .value, group = paste(oxygen_used, .draw)), \n              alpha = 0.1) + \n    labs(y = \"probability of success\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: `fitted_draws` and `add_fitted_draws` are deprecated as their names were confusing.\n- Use [add_]epred_draws() to get the expectation of the posterior predictive.\n- Use [add_]linpred_draws() to get the distribution of the linear predictor.\n- For example, you used [add_]fitted_draws(..., scale = \"response\"), which\n  means you most likely want [add_]epred_draws(...).\nNOTE: When updating to the new functions, note that the `model` parameter is now\n  named `object` and the `n` parameter is now named `ndraws`.\n```\n:::\n\n::: {.cell-output-display}\n![](18_notes_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n## 18.1.3 Posterior classification\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# New expedition\nnew_expedition <- data.frame(\n  age = c(20, 20, 60, 60), oxygen_used = c(FALSE, TRUE, FALSE, TRUE), \n  expedition_id = rep(\"new\", 4))\nnew_expedition\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  age oxygen_used expedition_id\n1  20       FALSE           new\n2  20        TRUE           new\n3  60       FALSE           new\n4  60        TRUE           new\n```\n:::\n\n```{.r .cell-code}\n# Posterior predictions of binary outcome\nset.seed(84735)\nbinary_prediction <- posterior_predict(climb_model, newdata = new_expedition)\n\n# First 3 prediction sets\nhead(binary_prediction, 3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     1 2 3 4\n[1,] 0 0 0 1\n[2,] 1 1 0 1\n[3,] 0 1 0 1\n```\n:::\n\n```{.r .cell-code}\n# Summarize the posterior predictions of Y\ncolMeans(binary_prediction)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n      1       2       3       4 \n0.28245 0.80435 0.14625 0.65225 \n```\n:::\n:::\n\n\n## 18.1.4 Model evaluation\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(84735)\nclassification_summary(data = climbers, model = climb_model, cutoff = 0.5)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n$confusion_matrix\n     y    0   1\n FALSE 1173  96\n  TRUE   77 730\n\n$accuracy_rates\n                          \nsensitivity      0.9045849\nspecificity      0.9243499\noverall_accuracy 0.9166667\n```\n:::\n\n```{.r .cell-code}\nset.seed(84735)\nclassification_summary(data = climbers, model = climb_model, cutoff = 0.65)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n$confusion_matrix\n     y    0   1\n FALSE 1214  55\n  TRUE  147 660\n\n$accuracy_rates\n                          \nsensitivity      0.8178439\nspecificity      0.9566588\noverall_accuracy 0.9026975\n```\n:::\n:::\n\n\n# 18.2 Hierarchical Poisson & Negative Binomial regression\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load data\ndata(airbnb)\n\n# Number of listings\nnrow(airbnb)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 1561\n```\n:::\n\n```{.r .cell-code}\n# Number of neighborhoods\nairbnb %>% \n  summarize(nlevels(neighborhood))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  nlevels(neighborhood)\n1                    43\n```\n:::\n:::\n",
    "supporting": [
      "18_notes_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}